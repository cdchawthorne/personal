# cdchawthorne

alias ls='ls --color=auto --group-directories-first'

alias grep='grep --colour=auto'
alias fgrep='fgrep --colour=auto'
alias egrep='egrep --colour=auto'

alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'
alias lr='ls -lrt'
alias liesl='ls'
alias s='ls'
alias sl='ls'

alias freedom!=free

function cd {
    builtin cd $@ && ls
}
alias scd='cd'
alias d='cd'
alias cd..='cd ..'
alias c='cd'
alias dc='cd'
alias dcd='cd'

alias xp='chmod +x'
alias ff='find . -name'
alias fr='find . -regex'
alias rlwrap='rlwrap -s 1000000'
alias math='rlwrap math'
alias racket='rlwrap racket'
alias mount='mount -o gid=users,fmask=113,dmask=002'
alias sudo='sudo '
alias xargs='xargs '
alias startx='builtin cd; command startx &> "${HOME}/.xsession-errors"'
alias p='cd ${HOME}/repos/personal'
alias k='pwsafe -p'

alias tim='vim -t'
alias vv='vim -c ''e $MYVIMRC'''
alias vz='vim ~/.zsh_aliases'
alias sz='source ~/.zsh_aliases'
function fim {
    vim -c "cs f f $1"
}

alias rh='rehash'

function timestamp {
    date +'%Y-%m-%d__%H-%M-%S'
}

function pa {
    if [[ $# -eq 0 ]]; then
        num=1
    else
        num=$1
    fi

    dest=.
    for i in $(seq ${num}); do
        dest=${dest}/..
    done
    cd ${dest}
}

function find-grep {
    find . -regex $1 | xargs egrep --colour=auto $2 |
            sed -re 's_^([^:]*):.*$_\1_g' | uniq
}

function to {
    cd "$(dirname $1)"
}

function pdf {
    for pdfFile in $@; do
        zathura --fork "$(realpath ${pdfFile})" &> /dev/null
    done
}

function tt {
    if [[ $# -ne 1 ]]; then
        echo "usage: tt DST_DIR" 1>&2
        return 1
    fi

    targets=(${HOME}/documents ${HOME}/media/pictures ${HOME}/utilities
             ${HOME}/.cdchawthorne_jade_db ${HOME}/.gnupg ${HOME}/.pere
             ${HOME}/.ssh ${HOME}/.config)
    find /etc -readable -type f | read-lines-array etc_files
    targets=(${targets} ${etc_files})
    tar -czf "$1/$(hostname)_$(timestamp).tar.gz" ${targets}
}

function rr {
    if [[ $# -lt 1 ]]; then
        echo "usage: rr SRC_DIRS" 1>&2
        return 1
    fi

    srcs=()
    for src in $@; do
        srcs=(${srcs} "$(realpath ${src})")
    done
    dest=cdchawth@csclub.uwaterloo.ca:/users/cdchawth/utilities/rsync_backups

    rsync -avzF --delete ${srcs} ${dest}
}

function to_ssh {
    if [[ $# -lt 1 ]]; then
        echo "usage: to_ssh SRCS" 1>&2
        return 1
    fi

    dest=cdchawth@linux.student.cs.uwaterloo.ca:/u8/cdchawthorne/scratch
    scp $@ ${dest}
}

function to_share {
    if [[ $# -lt 1 ]]; then
        echo "usage: to_share SRCS" 1>&2
        return 1
    fi

    dest=cdchawth@ugster18.student.cs.uwaterloo.ca:/home/cdchawth/uml/share
    scp $@ ${dest}
}

function x {
    if ! pgrep X &> /dev/null; then
        builtin cd
        command startx &> "${HOME}/.xsession-errors"
    fi
}

function xvim {
    if [[ -n ${DISPLAY} || ${zsh_parent_process} == sshd ]]; then
        echo -ne '\e[1 q'
    else
        echo -ne '\e[?6c'
    fi
    vim $@

    optionRegex='^-.*$'
    for arg in $@; do
        if [[ ! ${arg} =~ ${optionRegex} && -e ${arg} && ! -x ${arg} ]]; then
            chmod +x ${arg}
        fi
    done
}

function zvim {
    if [[ -n ${DISPLAY} || ${zsh_parent_process} == "sshd" ]]; then
        echo -ne '\e[1 q'
    else
        echo -ne '\e[?6c'
    fi
    vim -u <(cat << EOF
exe "source " fnameescape("${HOME}/.vimrc")
autocmd BufNewFile *
    \ setfiletype zsh |
    \ 0put = '#!/usr/bin/env zsh' |
    \ 1put = '' |
    \ normal G
EOF) $@

    optionRegex='^-.*$'
    for arg in $@; do
        if [[ ! ${arg} =~ ${optionRegex} && -e ${arg} && ! -x ${arg} ]]; then
            chmod +x ${arg}
        fi
    done
}

function python {
    (
        export INPUTRC=${HOME}/.pyinputrc
        command python $@
    )
}

alias alert='notify-send --urgency=low -i "$([ $? = 0 ] && echo terminal || echo error)" "$(history|tail -n1|sed -e '\''s/^\s*[0-9]\+\s*//;s/[;&|]\s*alert$//'\'')"'
